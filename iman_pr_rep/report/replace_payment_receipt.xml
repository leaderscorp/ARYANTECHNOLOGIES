<?xml version="1.0" encoding="UTF-8" ?>

<odoo>
    <data>
        <template id="iman_account_payment_receipt" inherit_id="account.report_payment_receipt_document">
            <xpath expr="//t" position="replace">

                <t t-call="web.external_layout">
<!--                    <header class="header">-->
<!--                        <h1>header</h1>-->
<!--                    </header>-->
<!--                    <div class="header">-->
<!--                        <h1>Header</h1>-->
<!--                    </div>-->
                    <t t-set="o" t-value="o.with_context(lang=lang)"/>


                    <div class="page">

<!--                        <h3>-->
<!--                            <strong>Payment Receipt:-->
<!--                                <span t-field="o.name"/>-->
<!--                            </strong>-->
<!--                        </h3>-->
                        <div class="mb-4 mt-3">
<!--                            <div class="row">-->
<!--                                <div class="col-6" t-if="o.date">-->
<!--                                    Payment Date:-->
<!--                                    <span t-field="o.date"/>-->
<!--                                </div>-->
<!--                            </div>-->
                            <div class="row" >
                                 <div class="col-9 mb-1" >
                                     <t t-if="o.journal_id.type == 'bank'">
                                        <span><b>Bank Account:</b></span>
                                         <span t-field="o.journal_id.default_account_id"/>
                                    </t>
                                    <t t-if="o.journal_id.type == 'cash'">
                                        <span><b>Cash Account:</b></span>
                                        <span t-field="o.journal_id.default_account_id"/>
                                    </t>
                                 </div>
                                <div class="col-3 text-end" t-if="o.partner_type">
                                     <b>NTN no: </b>
                                    <span t-field="o.partner_id.vat"/>
                                 </div>
                            </div>
                            <div class="row">
                                <div class="col-6 mb-1" t-if="o.partner_type">
<!--                                    <t t-if="o.partner_type == 'customer'">-->
<!--                                        Customer:-->
<!--                                    </t>-->
<!--                                    <t t-if="o.partner_type == 'supplier'">-->
<!--                                        Vendor:-->
<!--                                    </t>-->
                                    <b >Payment Receipt: </b>
                                    <span t-field="o.name"/>
<!--                                    <span t-field="o.partner_id"/>-->
<!--                                     <b>Payment Account:</b>-->
<!--                                    <t t-if="o.journal_id.type == 'bank'">-->
<!--                                        <t t-if="o.payment_type == 'outbound'">-->
<!--                                            <span><b>BPV</b></span>-->
<!--                                        </t>-->
<!--                                        <t t-else="">-->
<!--                                            <span><b>BRV</b></span>-->

<!--                                        </t>-->

<!--                                    </t>-->
<!--                                    <t t-elif="o.journal_id.type == 'cash'">-->
<!--                                        <t t-if="o.payment_type == 'outbound'">-->
<!--                                            <span><b>CPV</b></span>-->

<!--                                        </t>-->
<!--                                        <t t-else="">-->
<!--                                            <span><b>CRV</b></span>-->

<!--                                        </t>-->
<!--                                    </t>-->

                                </div>
                                <div class="col-6 mb-1 text-end" t-if="o.payment_method_id">
                                    <t t-if="o.journal_id.type == 'bank'">
                                        <span><b>Bank Code:</b></span>
                                    </t>
                                    <t t-if="o.journal_id.type == 'cash'">
                                        <span><b>Cash Code</b></span>
                                    </t>
                                    <span t-field="o.outstanding_account_id.code"/>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-6" t-if="o.amount">
                                    <b>Voucher No:</b>
                                    <span t-field="o.custom_name"/>
<!--                                    Payment Amount:-->
<!--                                    <span t-field="o.amount"-->
<!--                                          t-options="{'widget': 'monetary', 'display_currency': o.currency_id}"/>-->
                                </div>
                                <div class="col-6 text-end" t-if="o.ref">
<!--                                    Memo:-->
<!--                                    <span t-field="o.ref"/> -->
                                   <b> Date:</b>
                                    <span t-field="o.date"/>
                                </div>
                            </div>
                        </div>

                        <t t-set="partials" t-value="o.move_id._get_reconciled_invoices_partials()[0]"/>
                        <t t-set="invoices" t-value="{partial[2].move_id for partial in partials}"/>
                        <!-- Check if invoices include different currencies -->
                        <t t-foreach="invoices" t-as="inv">
                            <t t-if="any(inv.currency_id != par[2].currency_id for par in inv._get_reconciled_invoices_partials()[0])"
                               t-set="otherCurrency" t-value="True"/>
                        </t>

                        <table class="table table-sm">
                            <thead>
                                <tr>
                                    <th class="text-start" style="width:60%;">
                                        <div class="row">
                                            <div class="col-8 text-start">
                                                <span>Account Title</span>
                                            </div>

                                            <div class="col-4 text-end">
                                                <span>Account Code</span>
                                            </div>
                                        </div>
                                    </th>
<!--                                    <th>-->
<!--                                        <span>Account Code</span>-->
<!--                                    </th>-->
<!--                                    <th>-->
<!--                                        <span>Invoice Number</span>-->
<!--                                    </th>-->
                                    <th>
                                        <span>Amount</span>
                                    </th>
                                    <!-- Add a column if there are different currencies -->
<!--                                    <th t-if="otherCurrency" class="text-end">-->
<!--                                        <span>Amount In Currency</span>-->
<!--                                    </th>-->
<!--                                    <th>-->
<!--                                        <span>W.H Tax</span>-->
<!--                                    </th>-->
                                    <th class="text-center">
                                        <span>Total Amount</span>
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                 <t t-set="com" t-value="o.with_context(lang=lang)"/>
<!--                                 <t t-foreach="o" t-as="com">-->
<!--                                <t t-debug="pdb"/>-->
                                    <tr>
                                        <td>
                                            <div class="row">
                                                <div class="col-8 text-start">
                                                    <span t-field="com.partner_id"/>
                                                </div>
                                                <div class="col-4 text-end">
                                                    <span t-field="com.destination_account_id.code" />
                                                </div>
                                            </div>
                                        </td>
<!--                                        <td class="text-center"></td>-->
                                        <td class="text-end">
                                            <span t-out="'{:,.2f}'.format(com.amount)" t-options="{'widget': 'Float'}"/>
                                        </td>
<!--                                        <td class="text-end">-->
<!--                                            <span t-field="com.amount"/>-->
<!--                                        </td>-->
                                        <td class="text-end">
                                            <span t-out="'{:,.2f}'.format(com.amount)" t-options="{'widget': 'Float'}"/>
                                        </td>

                                    </tr>
                            </tbody>
                            <tbody>
                                    <tr>
                                        <td class="text-center fw-bold">
                                            <span>Total Amount</span>

                                        </td>
<!--                                        <td>-->
<!--                                            <span/>-->
<!--                                        </td>-->
                                        <td class="text-end">
                                            <span t-out="'{:,.2f}'.format(com.amount)" t-options="{'widget': 'Float'}"/>
                                        </td>
<!--                                        <td class="text-end">-->
<!--                                            <span t-field="com.amount"/>-->
<!--                                        </td>-->
                                        <td class="text-end">
                                            <span t-out="'{:,.2f}'.format(com.amount)" t-options="{'widget': 'Float'}"/>
                                        </td>

                                    </tr>
<!--                                </t>-->
<!--                                <t t-foreach="invoices" t-as="inv">-->
<!--                                    &lt;!&ndash; MOVE &ndash;&gt;-->
<!--                                    <t t-if="inv.move_type != 'entry'">-->
<!--                                        <tr>-->
<!--                                            <td>-->
<!--                                                <span t-field="inv.invoice_date"/>-->
<!--                                            </td>-->
<!--                                            <td>-->
<!--                                                <span t-field="inv.name"/>-->
<!--                                            </td>-->
<!--                                            <td>-->
<!--&lt;!&ndash;                                                <span t-field="inv.ref"/>&ndash;&gt;-->
<!--                                                <span t-field="o.amount"/>-->
<!--                                            </td>-->
<!--                                            <td t-if="otherCurrency"/>-->
<!--                                            <td class="text-end">-->
<!--                                                <span t-field="inv.amount_total"/>-->
<!--                                            </td>-->
<!--                                        </tr>-->
<!--                                        &lt;!&ndash; PAYMENTS/REVERSALS &ndash;&gt;-->
<!--                                        <tr t-foreach="inv._get_reconciled_invoices_partials()[0]" t-as="par">-->
<!--                                            <t t-set="payment" t-value="par[2].move_id"/>-->
<!--                                            <td>-->
<!--                                                <span t-field="payment.date"/>-->
<!--                                            </td>-->
<!--                                            <td>-->
<!--                                                <span t-field="payment.name"/>-->
<!--                                            </td>-->
<!--                                            <td>-->
<!--                                                <span t-field="payment.ref"/>-->

<!--                                            </td>-->
<!--                                            <t t-set="amountPayment" t-value="-payment.amount_total"/>-->
<!--                                            <t t-set="amountInvoice" t-value="-par[1]"/>-->
<!--                                            <t t-set="currencyPayment" t-value="payment.currency_id"/>-->
<!--                                            <t t-set="currencyInvoice" t-value="inv.currency_id"/>-->
<!--                                            &lt;!&ndash; Fill the column "Amount In Currency" only if necessary &ndash;&gt;-->
<!--                                            <td t-if="otherCurrency" class="text-end">-->
<!--                                                <span t-if="currencyPayment != currencyInvoice" t-esc="amountPayment"-->
<!--                                                      t-options="{'widget': 'monetary', 'display_currency': currencyPayment}"/>-->
<!--                                            </td>-->
<!--                                            <td class="text-end">-->
<!--                                                <span t-esc="amountInvoice"-->
<!--                                                      t-options="{'widget': 'monetary', 'display_currency': currencyInvoice}"/>-->
<!--                                            </td>-->
<!--                                        </tr>-->
<!--                                        &lt;!&ndash; BALANCE &ndash;&gt;-->
<!--                                        <tr>-->
<!--                                            <td/>-->
<!--                                            <td>-->
<!--                                                <strong>Due Amount for-->
<!--                                                    <span t-field="inv.name"/>-->
<!--                                                </strong>-->
<!--                                            </td>-->
<!--                                            <td/>-->
<!--                                            <td t-if="otherCurrency"/>-->
<!--                                            <td class="text-end">-->
<!--                                                <strong>-->
<!--                                                    <span t-field="inv.amount_residual"/>-->
<!--                                                </strong>-->
<!--                                            </td>-->
<!--                                        </tr>-->
<!--                                    </t>-->
<!--                                </t>-->
                            </tbody>
<!--                            <tbody style="border-bottom:none;">-->
<!--                            <tr style="border-bottom:none;">-->
<!--                                <td><b>Ledger Balance:</b></td>-->
<!--                                <td colspan="3" class="text-end">0.00</td>-->
<!--                            </tr>-->

<!--                            </tbody>-->
                        </table>
                         <tr>
                                <td><b>Ledger Balance:</b></td>
                                <div style="float:right; margin-right:10px;">
                                    <td >0.00</td>
                                </div>
                         </tr>
                        <br/>
                        <br/>
                        <span class="fw-bold">Rupees: </span><span class="text-capitalize" t-field="o.total_in_words"/><br/>
                        <span class="fw-bold">Narration: </span><span class="text-capitalize" t-field="o.ref"/>

                    </div>
                    <div class="footer">
                         <div class="row">
                            <div class="col-auto text-center">
                               <p class="mb-1">_______________________</p>
                                <b>Receipient Sign</b>
                            </div>
                             <div class="col-auto text-center">
                               <p class="mb-1">_______________________</p>
                                <b>Prepared by</b>
                            </div>
                             <div class="col-auto text-center">
                               <p class="mb-1">_______________________</p>
                                <b >Checked by</b>
                            </div>
                             <div class="col-auto text-center">
                               <p class="mb-1">_______________________</p>
                                <b >Finance by</b>
                            </div>
                            <div class="col-auto text-center">
                               <p class="mb-1">_______________________</p>
                                <b >Approved by</b>
                            </div>

                        </div>
                    </div>
                </t>
            </xpath>
        </template>
    </data>
</odoo>